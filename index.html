<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>天气App</title>
	<meta name="viewport" content="width=device-width, user-scalable=no,initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<link rel="stylesheet" href="css/public.css">
	<link rel="stylesheet" href="css/index.css">
	<script src="js/rem.js"></script>
	<link rel="icon" href="img/logo.ico" type="image/x-icon">
</head>
<body>
	<!-- 当前信息 -->
	<section id="now">
		<!-- 当前城市 -->
		<h1 class="now_city">
			<span class="address_icon">&lt;</span>
			<span class="now_city_name">太原</span>
		</h1>
		
		<!-- 当前空气质量 -->
		<div class="now_air">
			<h1>空气</h1>
			<h2></h2>
		</div>

		<!-- 当前温度 -->
		<h2 class="now_tem">
			<span></span>°
		</h2>

		<!-- 当前天气 --> 
		<h3 class="now_weather">
			<span></span>
		</h3>

		<!-- 当前风向以及风级 -->
		<div class="now_wind_box">
			<span class="now_wind">北风</span>
			<span class="now_wind_leavel"> 3级</span>
		</div>

		<!-- 当前温馨提示 -->
		<p class="now_notice">
			<span></span>
		</p>

	</section>

	<!-- 未来两天的天气信息 -->
	<section id="future">
		<div class="future_box today">
			<div class="future_top">
				<span class="future_date">今天</span>
				<p><span class="today_hightemp">4</span>/<span class="today_lowtemp">-10</span>°C</p>
			</div>

			<div class="future_top">
				<span class="todat_weather">多云</span>
                <div class="today_img"></div>
			</div>
		</div>
		<div class="future_box tomorrow">
			<div class="future_top">
				<span class="future_date">明天</span>
				<p><span class="tomorrow_hightemp">5</span>/<span class="tomorrow_lowtemp">-7</span>°C</p>
			</div>

			<div class="future_top">
				<span class="tomorrow_weather">多云</span>
                <div class="tomorrow_img"></div>
			</div>
		</div>
	</section>

	<!-- 未来24小时的信息 -->
	<ul id="hours">
		<li>
			<h1 class="hours_time">8:00</h1>
			<div class="hours_img">
				<img src="img/5.png" alt="">
			</div>
			<h2 class="hours_temp">
				<span>-8</span>°
			</h2>
		</li>

		<li>
			<h1 class="hours_time">9:00</h1>
			<div class="hours_img">
				<img src="img/6.png" alt="">
			</div>
			<h2 class="hours_temp">
				<span></span>°
			</h2>
		</li>

		<li>
			<h1 class="hours_time">10:00</h1>
			<div class="hours_img">
				<img src="img/7.png" alt="">
			</div>
			<h2 class="hours_temp">
				<span>-1</span>°
			</h2>
		</li>

		<li>
			<h1 class="hours_time">11:00</h1>
			<div class="hours_img">
				<img src="img/8.png" alt="">
			</div>
			<h2 class="hours_temp">
				<span>0</span>°
			</h2>
		</li>

		<li>
			<h1 class="hours_time">12:00</h1>
			<div class="hours_img">
				<img src="img/9.png" alt="">
			</div>
			<h2 class="hours_temp">
				<span>1</span>°
			</h2>
		</li>

		<li>
			<h1 class="hours_time">13:00</h1>
			<div class="hours_img">
				<img src="img/10.png" alt="">
			</div>
			<h2 class="hours_temp">
				<span>-2</span>°
			</h2>
		</li>
		<li>
			<h1 class="hours_time">14:00</h1>
			<div class="hours_img">
				<img src="img/3.png" alt="">
			</div>
			<h2 class="hours_temp">
				<span>-3</span>°
			</h2>
		</li>
	</ul>

	<!-- 未来一周的信息 -->
	<ul id="weeks">
		<li>
			<h1 class="weeks_date">02</h1>/<h1 class="weeks_date">06</h1>
			<h1 class="weeks_weather">多云转晴</h1>
			<div class="weeks_img">
				<img src="img/13.png" alt="">
			</div>
			<h2 class="weeks_max">4</h2>
			<h2 class="weeks_min">-14</h2>
			<h1 class="weeks_fengxiang">西北风</h1>
			<h1 class="weeks_fengji">
				<span>3</span>级
			</h1>
		</li>

		<li>
			<h1 class="weeks_date">02</h1>/<h1 class="weeks_date">06</h1>
			<h1 class="weeks_weather">多云转晴</h1>
			<div class="weeks_img">
				<img src="img/13.png" alt="">
			</div>
			<h2 class="weeks_max">3</h2>
			<h2 class="weeks_min">-12</h2>
			<h1 class="weeks_fengxiang">西北风</h1>
			<h1 class="weeks_fengji">
				<span>3</span>级
			</h1>
		</li>

		<li>
			<h1 class="weeks_date">02</h1>/<h1 class="weeks_date">07</h1>
			<h1 class="weeks_weather">多云</h1>
			<div class="weeks_img">
				<img src="img/5.png" alt="">
			</div>
			<h2 class="weeks_max">4</h2>
			<h2 class="weeks_min">-14</h2>
			<h1 class="weeks_fengxiang">西北风</h1>
			<h1 class="weeks_fengji">
				<span>3</span>级
			</h1>
		</li>

		<li>
			<h1 class="weeks_date">02</h1>/<h1 class="weeks_date">08</h1>
			<h1 class="weeks_weather">多云转晴</h1>
			<div class="weeks_img">
				<img src="img/5.png" alt="">
			</div>
			<h2 class="weeks_max">5</h2>
			<h2 class="weeks_min">-7</h2>
			<h1 class="weeks_fengxiang">西北风</h1>
			<h1 class="weeks_fengji">
				<span>3</span>级
			</h1>
		</li>

		<li>
			<h1 class="weeks_date">02</h1>/<h1 class="weeks_date">09</h1>
			<h1 class="weeks_weather">多云转晴</h1>
			<div class="weeks_img">
				<img src="img/13.png" alt="">
			</div>
			<h2 class="weeks_max">4</h2>
			<h2 class="weeks_min">-14</h2>
			<h1 class="weeks_fengxiang">西北风</h1>
			<h1 class="weeks_fengji">
				<span>3</span>级
			</h1>
		</li>

		<li>
			<h1 class="weeks_date">02</h1>/<h1 class="weeks_date">10</h1>
			<h1 class="weeks_weather">多云转晴</h1>
			<div class="weeks_img">
				<img src="img/15.png" alt="">
			</div>
			<h2 class="weeks_max">4</h2>
			<h2 class="weeks_min">-10</h2>
			<h1 class="weeks_fengxiang">西北风</h1>
			<h1 class="weeks_fengji">
				<span>3</span>级
			</h1>
		</li>

		<li>
			<h1 class="weeks_date">02</h1>/<h1 class="weeks_date">11</h1>
			<h1 class="weeks_weather">多云转晴</h1>
			<div class="weeks_img">
				<img src="img/17.png" alt="">
			</div>
			<h2 class="weeks_max">4</h2>
			<h2 class="weeks_min">-14</h2>
			<h1 class="weeks_fengxiang">西北风</h1>
			<h1 class="weeks_fengji">
				<span>3</span>级
			</h1>
		</li>
	</ul>

	<main id="citys">
		<header>
			<input type="text" class="search" placeholder="请输入搜索内容">
			<h2 class="btn">取消</h2>
		</header>
		<div class="remen_city">
			<div class="remen_city_top">
				<h1 class="renmen_wenzi"></h1>
			</div>
			<div class="remen_city_bottom">
			</div>
		</div>
	</main>
<script src="js/jquery.js"></script>
<script>
$.getScript("https://int.dpool.sina.com.cn/iplookup/iplookup.php?format=js",function(){
    var data=remote_ip_info;
    var city=data.city;
    $(".now_city_name").html(city);
    getWeather(city);
});
function getWeather(city){
$.ajax({
    url:"https://api.jisuapi.com/weather/query?appkey=6e1dc983dbe0288e&city="+city,
    dataType:"jsonp",
    success:function(r){
        let data=r.result.daily;
        let kongqi=r.result.aqi;
        let data2=r.result.index;
        let data0=data[0];
        let data1=data[1];
        let img1=data0.day.img;
        let img2=data1.day.img;
        $(".now_air>h2").html(kongqi.quality);
        $(".now_tem>span").html(data0.day.temphigh);
        $(".now_weather>span").html(data0.day.weather);
        $(".now_wind").html(data0.day.winddirect);
        $(".now_wind_leavel").html(data0.day.windpower);
        $(".now_notice>span").html(data2[0].detail);
        $(".today_hightemp").html(data0.day.temphigh);
        $(".today_lowtemp").html(data0.night.templow);
        $(".todat_weather").html(data0.day.weather);

        str1=`<img src="weathercn02/${img1}.png" alt="">`;
        $(".today_img").html(str1);

        $(".tomorrow_hightemp").html(data1.day.temphigh);
        $(".tomorrow_lowtemp").html(data1.night.templow);
        $(".tomorrow_weather").html(data1.day.weather);

        str3=`<img src="weathercn02/${img2}.png" alt="">`;
        $(".tomorrow_img").html(str3);

        let hour=r.result.hourly;
        let str2="";
        $.each(hour,function (index,val) {
            str2+=`<li>
				<h1 class="hours_time">${val.time}</h1>
				<div class="hours_img">
					<img src="weathercn02/${val.img}.png" alt="">
				</div>
				<h2 class="hours_temp"><span>${val.temp}</span>°</h2>
			</li>`
        })
        $("#hours").html(str2);

		let str="";
        $.each(data,function(index,val){
            str+=`<li>
<h1 class="weeks_date">${val.date}</h1>
    <h1 class="weeks_weather">${val.day.weather}/${val.night.weather}</h1>
    <div class="weeks_img">
        <img src="weathercn02/${val.day.img}.png" alt="">
        <img src="weathercn/${val.night.img}.png" alt="">
    </div>
    <h2 class="weeks_max">${val.day.temphigh}℃</h2>
    <h2 class="weeks_min">${val.night.templow}℃</h2>
    <h1 class="weeks_fengxiang">${val.day.winddirect}</h1>
    <h1 class="weeks_fengji">
        <span>${val.day.windpower}</span>
    </h1>
</li>`;
        });
        $("#weeks").html(str);
        console.log(r);
    }
})
}
$(".now_city_name").click(function(){
$("#citys").show();
var data=[]; //存放所有的数据
var province=[]; //存放所有省的数据
var city=[];    //存放某个省的所有市
$.ajax({
    url:"https://api.jisuapi.com/weather/city?appkey=6e1dc983dbe0288e",
    dataType:"jsonp",
    success:function(r){
        data=r.result;
        province=$.grep(data,function(val,index){
            if(val.parentid==="0"){
                return true;
            }
        });
        let str="";
        $.each(province,function(index,val){
            str+=`<div class="remen_city_top">
			<h1 class="renmen_wenzi" id="${val.cityid}">${val.city}</h1>
			</div>`;
        });
        $(".remen_city").html(str);
    }
});
$(".remen_city").on("click",".renmen_wenzi",function(){
    var id=$(this).attr("id");
    city=$.grep(data,function(val,index){
        if(val.parentid===id){
            return true;
        }
    });
    $(".remen_city").empty();
    let str="";
    $.each(city,function(index,val){
        str+=`<div class="city_name">${val.city}</div>`;
    });
    $(".remen_city").html(str);
});
$("#citys").on("click",".city_name",function(){
    $("#citys").hide();
    getWeather($(this).html());
    let city1=$(this).html();
    $(".now_city_name").html(city1);
})
})
</script>
</body>
</html>